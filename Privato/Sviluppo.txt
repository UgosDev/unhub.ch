# Note di Sviluppo e Roadmap per scansioni.ch

Questo documento traccia le idee, la pianificazione e lo storico dello sviluppo dell'applicazione. È organizzato in tre sezioni principali:
1.  **Roadmap**: Le prossime funzionalità prioritarie.
2.  **Backlog**: Un elenco categorizzato di idee e miglioramenti per il futuro.
3.  **Log di Sviluppo**: Lo storico cronologico delle modifiche apportate, versione per versione.

---

## 1. ROADMAP DI SVILUPPO (IDEE PRIORITARIE)

Elenco delle prossime funzionalità su cui concentrarsi.

### 1.1. Integrazione Pagamenti Reali
- **Problema**: Attualmente la gestione degli abbonamenti e dei pacchetti è simulata.
- **Soluzione**: Integrare un sistema di pagamento reale (es. Stripe) per gestire gli abbonamenti mensili e l'acquisto di pacchetti di scansioni. Questo include la creazione di una UI per la gestione del piano da parte dell'utente.

---

## 2. BACKLOG DELLE IDEE (DA CONSIDERARE)

Lista di funzionalità e miglioramenti futuri, organizzati per categoria.

### Espansione Ecosistema (Nuovi Moduli Potenziali)
- **fogli.ch**: Sistema di condivisione sicura di stampanti. Permette agli utenti di trovare e utilizzare stampanti nella loro zona quando non ne hanno una a disposizione, gestendo il processo di stampa in modo sicuro.
- **rimborsi.ch**: Modulo per la gestione dei rimborsi spese. Funziona in modo simile a `polizze.ch`, permettendo di archiviare scontrini, fatture e ricevute e di generare facilmente richieste di rimborso (via PDF o email) da inviare a datori di lavoro o enti.

### Funzionalità Principali
- **Modalità Batch Asincrona**: Possibilità di inviare scansioni a un orario prestabilito (es. notte) a un costo ridotto. Richiede infrastruttura backend.
- **Potenziamento Esportazione PDF**: Aggiungere opzioni avanzate come la selezione della qualità, l'inclusione dei dati estratti e la protezione con password personalizzata per i PDF.
- **Metadati Avanzati**: Espandere i metadati per includere dati EXIF/XMP completi nelle immagini, offrendo una tracciabilità di livello professionale.
- **Integrazione Import da App di Messaggistica**: Aggiungere la possibilità di caricare documenti da scansionare direttamente da Telegram o WhatsApp. La prima fase si concentrerà solo sull'importazione (input), con la gestione delle risposte (invio file modificati) da implementare in un secondo momento.
- **Integrazione Deep Scan Cloud**: Possibilità di avviare una scansione massiva ("Deep Scan") su servizi come Google Drive, Google Foto, o sul filesystem del dispositivo.
- **Reintroduzione Rilevamento Duplicati**: Potenziare o ripristinare la logica per identificare e gestire i documenti duplicati in modo efficace.
- **Ricarica Indirizzo Email Temporaneo**: Aggiungere un pulsante per generare un nuovo indirizzo email per l'importazione una volta scaduto quello precedente.

### UI/UX & Fotocamera
- **"Solidificazione" UI**: Revisione generale dell'interfaccia per migliorare la coerenza, gli spazi e l'impatto visivo.
- **Scansione Doppia Pagina (Modalità Libro)**: La fotocamera dovrebbe mostrare una guida per inquadrare due pagine di un libro contemporaneamente e dividerle automaticamente.
- **Pre-elaborazione Immagini**: Introdurre passaggi client-side (bianco e nero, contrasto, ottimizzazione peso) per migliorare la qualità dell'immagine inviata all'AI e ridurre i tempi di caricamento.
- **Visualizzazione UUID**: Aggiungere la possibilità di visualizzare l'UUID completo del documento direttamente nell'interfaccia dei risultati, magari in una sezione espandibile.
- **Miglioramento Caricamento File Mobile**: Ripristinare il comportamento del selettore file su mobile per permettere l'accesso diretto ai "Documenti" del telefono, oltre che alla galleria fotografica.
- **Effetto 3D per "Bolla" di Allineamento**: Migliorare graficamente l'indicatore di livello nella fotocamera per dargli un aspetto più tridimensionale e realistico.
- **Scatto Continuo di Default**: Modificare la fotocamera per abilitare di default lo scatto multi-pagina, con un ritardo di 2 secondi tra una scansione automatica e l'altra, e un pulsante "Fine" per terminare la sessione.

### Potenziamenti Chatbot "Ugo" (Idee Future)
- **Ugo Detective (Implementato)**: Ricerca semantica basata su contenuto, non solo titolo.
- **Ugo Summarizer (Implementato)**: Riepilogo e Q&A su più documenti selezionati.
- **Ugo Workspace-Aware (Implementato)**: Visione d'insieme e Q&A su tutti i documenti nell'area di lavoro.
- **Ugo Workflows (Automazione Intelligente)**: Ugo osserva le abitudini dell'utente e propone di automatizzare i compiti ripetitivi (es. "Ho notato che gestisci le fatture di E-Corp sempre allo stesso modo. Vuoi creare un 'Workflow'?").
- **Ugo On-the-Fly (Modifiche Conversazionali)**: Permettere di correggere i dati estratti tramite comandi vocali/testuali (es. "Ugo, correggi la data di scadenza di questa fattura. Metti il 30 settembre 2025.").
- **Sensibilità al Feedback Scansioni**: Ugo dovrebbe rilevare quando un utente lascia un feedback negativo su una scansione e avviare una conversazione per chiedere maggiori dettagli sul problema.

### Sicurezza, Monetizzazione e Infrastruttura
- **Anti-Spam per Chatbot (Implementato)**: Implementate misure anti-spam per il chatbot, includendo i filtri di sicurezza di Gemini per i contenuti e un limite di frequenza (rate limiting) lato client per prevenire flood di messaggi.
- **Blocco Geografico e Rilevamento VPN**: Implementare un sistema backend per limitare l'accesso al servizio solo agli utenti in Svizzera e per bloccare l'uso di VPN/proxy per aggirare le restrizioni. Richiede integrazione con servizi di IP Intelligence.
- **Modalità "Lock"**: Nuova modalità a 45 SC che rende un documento scansionato a prova di manomissione, garantendo l'immutabilità anche nelle app partner.
- **Ricarica Automatica ScanCoin**: Impostare una soglia minima di saldo per la ricarica automatica (richiede integrazione pagamenti).
- **Pagina "Aiuta a Migliorare"**: Creare una sezione dove gli utenti possono contribuire a validare dati in cambio di crediti.
- **Pagina Hiring**: Pagina per future assunzioni.
- **Database Remoto (Implementato)**: Migrazione completa a Google Firebase Firestore per la persistenza e sincronizzazione in tempo reale dei dati utente.
- **Pagine Legali**: Redigere e aggiungere pagine dettagliate per Privacy Policy e Termini di Servizio. (Testi segnaposto implementati, richiedono revisione legale).
- **Blacklist Email Comunitaria**: Implementare un sistema di blacklist per l'importazione via email, con la possibilità per gli utenti di contribuire a una lista condivisa per bloccare mittenti di spam o phishing noti.

---

## 3. LOG DI SVILUPPO (NOTE STORICHE)

Cronologia delle note di lavoro per ogni versione rilasciata.

# Note del 08/10/2025 - v8.6.1
- Aggiornamento della documentazione interna e preparazione per le prossime funzionalità. Allineamento dei file di versioning e log.

# Note del 07/10/2025 - v8.0.0
- **Major Version Bump**: Aggiornata la versione a 8.0.0 per riflettere la transizione a un ecosistema multi-sito unificato.
- **Architettura Modulare**: Completata la prima fase di implementazione della nuova architettura. L'app ora gestisce i moduli `archivio.ch`, `polizze.ch` e `disdette.ch`.
- **Branding Dinamico**: L'header e la navigazione cambiano dinamicamente logo e colori in base al modulo attivo.
- **Routing per Dominio**: Implementata la logica per indirizzare l'utente al modulo corretto in base al dominio di accesso.
- **Spostamento Interno**: Rimpiazzato il sistema di invio esterno con uno spostamento interno dei documenti tra `workspace` e i moduli finali.
- **Aggiornamento Documentazione**: Aggiornati tutti i file di documentazione (README, CHANGELOG, metadata) per riflettere questa importante evoluzione.

# Note del 06/10/2025 - v7.5.0
- **Implementazione Sincronizzazione in Tempo Reale**: Eseguito un refactoring completo dell'architettura dati per renderla reattiva e sincronizzata tra i dispositivi.
- **Da `get` a `onSnapshot`**: Sostituito il caricamento dati una tantum con listener in tempo reale (`onSnapshot`) in `services/firestoreService.ts` per tutte le collezioni principali (profilo utente, risultati, storico, chat).
- **Context Reattivo**: Aggiornato `AuthContext.tsx` per iscriversi agli aggiornamenti del profilo utente, garantendo che il saldo ScanCoin e altri dati siano sempre sincronizzati.
- **App Reattiva**: Modificato `App.tsx` per utilizzare i nuovi listener, assicurando che l'interfaccia utente si aggiorni istantaneamente a qualsiasi modifica proveniente dal database, sia essa locale o da un altro dispositivo.
- **Documentazione**: Aggiornati i file `README.md`, `CHANGELOG.md` e `LandingPage.tsx` per riflettere questa nuova, importante funzionalità. L'app è ora un'esperienza cloud-native a tutti gli effetti.
- Aggiornata la versione a 7.5.0.

# Note del 05/10/2025 - v7.4.3
- **Modello di Consenso Opt-In**: Implementato un nuovo flusso di consenso per l'analisi dei documenti da parte di Ugo, basato su un modello "opt-in" per una maggiore protezione della privacy.
- **Nuova Impostazione**: Aggiunta l'opzione `ugoContextAwarenessEnabled` (disattivata di default) in `services/settingsService.ts`.
- **UI di Attivazione**: Aggiunto un interruttore dedicato in `pages/ProfilePage.tsx` per permettere all'utente di attivare/disattivare la funzionalità.
- **Logica Contestuale**: Modificata la funzione `handleSendMessage` in `App.tsx`. Se la funzione è disattivata, Ugo rileva le domande che richiedono contesto e risponde con un messaggio predefinito che invita l'utente ad attivare la funzione, includendo un'azione `[ACTION:navigate_to_profile]`.
- **Istruzioni AI Aggiornate**: Il system prompt di Ugo è stato aggiornato per gestire correttamente entrambi gli scenari (con e senza contesto).
- Aggiornata la documentazione e la versione a 7.4.3.

# Note del 04/10/2025 - v7.4.2
- **Correzione Bug Critico**: Risolto un problema nel flusso di consenso del chatbot in `App.tsx`. Anche dopo che l'utente dava il consenso, la variabile di stato locale non veniva aggiornata, causando la visualizzazione del messaggio di privacy ad ogni interazione. La logica è stata corretta per procedere immediatamente dopo aver ottenuto il consenso.
- Aggiornata la documentazione e la versione a 7.4.2.

# Note del 03/10/2025 - v7.4.1
- **Correzione**: Implementata l'interfaccia utente per la sezione "Impostazioni Chatbot" in `ProfilePage.tsx`, che era stata omessa nella versione precedente. La sezione ora contiene correttamente gli interruttori per la proattività e la gamification, il pulsante per resettare la chat e la lista delle chat archiviate.
- Aggiornata la documentazione e la versione a 7.4.1.

# Note del 02/10/2025 - v7.4.0
- Implementate le richieste per migliorare la gestione della chat.
- **Nuovo Pulsante Impostazioni**: Aggiunta un'icona a ingranaggio nell'header della chat che porta alla pagina Profilo.
- **Sezione Impostazioni Chatbot**: Creata una nuova sezione in `ProfilePage.tsx` per centralizzare le opzioni di Ugo:
    - **Controllo Proattività**: Switch per abilitare/disabilitare i suggerimenti automatici.
    - **Controllo Gamification**: Switch per abilitare/disabilitare le ricompense.
    - **Gestione Cronologia**: Aggiunto un pulsante per cancellare la chat corrente.
    - **Archivio Chat**: Spostata la lista delle chat archiviate in questa nuova sezione.
- **Chiarimento Consenso**: Specificato nel changelog che il popup di consenso unico viene mostrato una sola volta anche agli utenti esistenti.
- Aggiornata la documentazione e la versione a 7.4.0.

# Note del 02/10/2025 - v7.3.0
- **Potenziamento Visione Ugo**: Implementata una modifica fondamentale per rendere Ugo un vero assistente contestuale. Ora, prima di ogni domanda dell'utente, l'app inietta nel prompt un riepilogo di tutti i documenti presenti nell'area di lavoro.
- **Istruzioni di Sistema Rafforzate**: Modificato il system prompt di Ugo per istruirlo esplicitamente ad usare il contesto fornito e a non rispondere mai più di non poter vedere i documenti per privacy. Rafforzata anche la regola sulla generazione del JSON per evitare il wrapping in markdown.
- **Consenso Privacy Unico**: Sostituito il consenso "just-in-time" con un modello di consenso globale. La prima volta che Ugo deve analizzare i documenti, chiede un'autorizzazione unica che viene salvata in modo persistente.
- Queste modifiche risolvono il problema della "cecità" di Ugo, lo rendono un assistente molto più potente e gestiscono la privacy in modo trasparente e non ripetitivo.
- Aggiornata tutta la documentazione e la versione a 7.3.0.

# Note del 01/10/2025 - v7.2.0
- **Correzione Bug Ugo**: Risolto un problema critico per cui le azioni JSON di Ugo non venivano eseguite. La causa era il wrapping del JSON in blocchi di markdown da parte di Gemini. Aggiunta una logica di pulizia della stringa prima del parsing per risolvere il problema in modo robusto.
- **Potenziamento Ugo - Detective**: Migliorata la capacità di ricerca di Ugo. Ora, quando gli viene chiesto di trovare dei documenti, la sua ricerca non si limita ai titoli ma si estende al contenuto, ai soggetti e ai riassunti, fornendo risultati più pertinenti.
- **Potenziamento Ugo - Summarizer**: Introdotta una nuova potente funzionalità. Gli utenti possono selezionare più fascicoli e cliccare "Chiedi a Ugo" per avviare una conversazione contestuale. Ugo può riassumere i documenti, confrontarli o rispondere a domande specifiche su di essi.
- **Consenso Privacy**: Per la funzione "Summarizer", è stato aggiunto un popup di consenso che informa l'utente che il contenuto dei documenti verrà inviato all'AI. Il consenso viene salvato per non essere richiesto nuovamente.
- Aggiornata tutta la documentazione e la versione a 7.2.0.

# Note del 30/09/2025 - v7.1.1
- Implementate due funzionalità dal backlog per migliorare il flusso di lavoro.
- **Scatto Continuo di Default**: La fotocamera ora si avvia in modalità multi-pagina, con una pausa di 2 secondi tra gli scatti automatici per facilitare il riposizionamento dei documenti.
- **Copia Rapida UUID**: Aggiunto un pulsante "Copia ID" su ogni pagina analizzata per copiare rapidamente l'identificativo univoco del documento.
- Aggiornata tutta la documentazione e la versione a 7.1.1.

# Note del 29/09/2025 - v7.0.1
- Implementate le misure anti-spam per il chatbot "Ugo".
- **Filtro Contenuti**: Applicate le `safetySettings` di Gemini a tutte le conversazioni per bloccare contenuti dannosi (harassment, hate speech, etc.) a livello di API.
- **Rate Limiting**: Introdotto un limite di frequenza lato client in `Chatbot.tsx` per prevenire l'invio di messaggi troppo ravvicinati. L'utente riceve un feedback visivo con un timer di cooldown.
- Aggiornata tutta la documentazione e la versione a 7.0.1.

# Note del 28/09/2025 - v6.44.0
- Implementato il "Selettore Intelligente" che suggerisce proattivamente la modalità di scansione dopo il caricamento dei file.
- Implementata la modalità di "Fallback Offline",attivabile dal profilo, che permette di continuare a lavorare senza connessione internet usando un motore locale.
- Modificato il flusso di lavoro: i file caricati vengono messi in attesa e l'utente deve confermare l'aggiunta alla coda di elaborazione.
- Aggiornata la base di conoscenza dell'assistente AI "Ugo" per includere le nuove funzionalità.
- Aggiornata la documentazione e la versione a 6.44.0.

# Note del 27/09/2025 - v6.43.0
- Implementate le tre proposte discusse con l'utente.
  1. **Nuovo Modello Documenti d'Identità**: Aggiunta la modalità "identity" in `geminiService` con uno schema specializzato, un costo dedicato (20 ScanCoin) e la logica per trasformare l'output in un formato standard. Aggiornata tutta l'UI (`ProcessingModeSelector`, `ModeInfoModal`, ecc.) per includere la nuova modalità.
  2. **Offset Lente d'Ingrandimento**: Modificata la funzione `draw` nel componente `CropView` (`CameraView.tsx`) per renderizzare la lente d'ingrandimento in una posizione fissa (angolo in alto a sinistra), evitando che venga coperta dal dito dell'utente.
  3. **Riprogettazione Pagina Changelog**: Modificato `ChangelogPage.tsx` per aggiungere una sezione "Roadmap Futura" statica e per parsare il file `CHANGELOG.md` in modo più intelligente, mostrando etichette colorate per tipo di modifica (`Aggiunto`, `Migliorato`, ecc.). Aggiornato il file `CHANGELOG.md` con il nuovo formato.
- Aggiornata la documentazione e la versione a 6.43.0.

# Note del 26/09/2025 - v6.42.0
- Implementata la richiesta di rendere il tutorial sempre accessibile.
- **Profilo Utente**: Aggiunto un pulsante "Avvia Tour Guidato" nella pagina del Profilo.
- **Assistente Ugo**: Potenziato Ugo per riconoscere comandi come "avvia il tutorial" ed eseguire l'azione corrispondente.
- **Refactoring**: La funzione `startTutorial` ora resetta lo stato (selezioni, gruppi espansi) per un avvio pulito.
- Aggiornata tutta la documentazione e la versione a 6.42.0.

# Note del 25/09/2025 - v6.41.0
- Implementata la richiesta di ampliare il tutorial e potenziare il pulsante "Prova Demo".
- **Tutorial Esteso**: Il tour guidato è stato esteso da 6 a 12 passaggi per coprire tutte le funzionalità chiave, inclusa l'interazione con i risultati, la selezione multipla e la navigazione.
- **Tutorial Interattivo**: Il tour ora esegue azioni (es. espandere un fascicolo, selezionarne un altro) per guidare l'utente in modo più dinamico.
- **Pulsante Demo Potenziato**: Cliccando "Prova Demo", l'app ora chiede conferma se l'area di lavoro non è vuota. Successivamente, carica i dati di esempio e chiede all'utente se vuole iniziare il tour guidato, rendendolo sempre accessibile.
- Aggiornata tutta la documentazione e la versione a 6.41.0.

# Note del 24/09/2025 - v6.40.0
- Riprogettata completamente l'interfaccia e la logica della fotocamera per un'esperienza moderna e professionale.
- **UI Moderna**: Riscritto `CameraView.tsx` con un layout a controlli "fluttuanti" e animazioni fluide.
- **"Ugo Experience" Potenziata**: Introdotta la "Ugo Experience" con una maschera 3D dinamica (`DynamicMeshOverlay.tsx`) che combina i dati di OpenCV e Gemini per una guida visiva precisa e reattiva. Aggiunto `useUgoExperience.ts` per incapsulare la logica di streaming Gemini a bassa latenza.
- **Galleria Multi-Scatto**: Aggiunta una nuova vista galleria (`GalleryView` in `CameraView.tsx`) per gestire le scansioni multiple.
- **Ritaglio di Precisione**: Potenziato il `CropView` con una lente d'ingrandimento per un posizionamento accurato degli angoli.
- **Modularizzazione del Codice**: La logica della fotocamera è stata scomposta in custom hook e componenti dedicati per una migliore manutenibilità.
- Aggiornata tutta la documentazione e la versione a 6.40.0.

# Note del 23/09/2025 - v6.39.0
- Implementato il miglioramento richiesto per la selezione flessibile della modalità di scansione.
- Rimosso il blocco (`disabled`) dal selettore di modalità in `Workspace.tsx`, consentendo all'utente di scegliere la modalità per i prossimi file da caricare anche mentre la coda di elaborazione è attiva.
- Ogni file accodato ora conserva la modalità selezionata al momento del suo caricamento, permettendo di avere una coda di lavoro eterogenea.
- Aggiornata tutta la documentazione e la versione a 6.39.0.

# Note del 22/09/2025 - v6.38.0
- Reimplementate le funzionalità proattive e di gamification del chatbot "Ugo".
- **Assistenza Proattiva**: Ugo ora avvia autonomamente conversazioni se rileva documenti non sicuri o un saldo ScanCoin basso. La logica utilizza `sessionStorage` per evitare di mostrare lo stesso avviso più volte.
- **Gamification (Sentiment)**: Ugo ora analizza il sentiment dei messaggi dell'utente. Se l'interazione è positiva dopo un certo numero di messaggi, l'utente viene premiato con 50 ScanCoin bonus. La ricompensa è limitata a una per sessione.
- Aggiunta la funzione `analyzeSentimentForGamification` in `geminiService.ts`.
- Aggiornata tutta la documentazione e la versione a 6.38.0.

# Note del 21/09/2025 - v6.37.0
- Reimplementato il chatbot "Ugo" dopo il suo temporaneo disabilitamento.
- **Refactoring Architettura**: La logica della chat è stata ricostruita utilizzando l'API `ai.chats.create` di Gemini, che è ottimizzata per conversazioni multi-turno e garantisce maggiore stabilità e coerenza.
- **Funzionalità Complete**: Tutte le funzionalità di Ugo, incluse le azioni sull'interfaccia (es. `setTheme`, `findAndMerge`) e le logiche di gamification, sono state ripristinate e testate.
- **Correzione Bug**: Corretto un bug nella funzione `redo` (Ripristina) del custom hook `useHistoryState`, che erroneamente si comportava come `undo` (Annulla).
- Aggiornata tutta la documentazione e la versione a 6.37.0.

# Note del 20/09/2025 - v6.36.0
- Implementato il tour guidato interattivo per i nuovi utenti.
- Creato il nuovo componente `TutorialManager.tsx` per gestire la logica e l'UI del tour (overlay, highlight, tooltip).
- Aggiunto lo stato e la logica di controllo del tour in `App.tsx`.
- Il tour si avvia cliccando sul banner che appare su un'area di lavoro vuota, carica i dati demo e guida l'utente attraverso 6 passaggi chiave.
- Aggiunti gli ID necessari ai componenti target (`Workspace`, `FileDropzone`, `ResultsDisplay`) per l'evidenziazione.
- Aggiornata tutta la documentazione e la versione a 6.36.0.

# Note del 19/09/2025 - v6.35.0
- Sostituito il motore di scansione OpenCV con una versione più avanzata e robusta basata sul codice fornito dall'utente.
- Il nuovo motore (`documentScannerEngine.ts`) utilizza una pipeline di elaborazione migliorata (soglia adattiva, filtri morfologici) e include la classificazione del tipo di documento in tempo reale.
- La gestione della memoria del motore è stata resa più sicura e robusta per prevenire memory leak.
- Aggiornata la `CameraView.tsx` per mostrare un badge con il tipo di documento rilevato.
- Aggiornata tutta la documentazione e la versione a 6.35.0.

# Note del 18/09/2025 - v6.34.0
- Implementate due richieste di miglioramento dell'esperienza utente.
- **Menu Circolare Potenziato**: Aggiunta la logica per un'interazione "premi e rilascia". L'azione viene eseguita al rilascio del tasto destro, offrendo un flusso rapido per utenti esperti.
- **Selettore Tema Semplificato**: Rimosso il sottomenu dal menu contestuale globale e sostituito con tre opzioni dirette (Chiaro, Scuro, Sistema) con icone dedicate, per un cambio tema più immediato.
- Aggiornata tutta la documentazione e la versione a 6.34.0.

# Note del 17/09/2025 - v6.33.0
- Implementate le due funzionalità di menu contestuale richieste dall'utente.
  1. **Menu Contestuale Globale**: Attivato con il tasto destro su aree vuote, offre scorciatoie per cambio tema, navigazione e avvio scansioni.
  2. **Menu Contestuale per Storico**: Attivato con il tasto destro su una riga dello storico, permette di trovare il fascicolo, segnalare un problema o creare una scansione simile.
- La funzione "Trova Fascicolo" scorre fino al documento e lo evidenzia con un'animazione.
- Aggiornata tutta la documentazione e la versione a 6.33.0.

# Note del 16/09/2025 - v6.32.0
- Implementato il nuovo **Menu Contestuale Circolare** per i fascicoli.
- Il menu si attiva con il tasto destro e offre accesso rapido a tutte le azioni principali (seleziona, espandi, invia, scarica ZIP/PDF, dividi).
- Creato il nuovo componente riutilizzabile `CircularContextMenu.tsx`.
- Aggiornata tutta la documentazione e la versione a 6.32.0.

# Note del 15/09/2025 - v6.31.0
- Potenziato il chatbot "Ugo" per renderlo interattivo.
- **Centralizzazione Stato**: Lo stato delle preferenze (tema, modalità primarie) è stato spostato in `App.tsx` per essere accessibile globalmente. `ProfilePage` è stato aggiornato per ricevere queste impostazioni come props.
- **Nuove Azioni Chatbot**: Aggiunte le azioni `setTheme` e `setPrimaryModes` alle istruzioni di sistema di Ugo. `handleBotFunctionCall` è stato ampliato per eseguire queste azioni e inviare messaggi di conferma.
- **Feedback Conversazionale**: Aggiunta la funzione `handleFeedbackResponse` e aggiornato `Chatbot.tsx` per permettere a Ugo di rispondere quando un utente clicca sui pulsanti di feedback.
- Aggiornata tutta la documentazione e la versione a 6.31.0.

# Note del 14/09/2025 - v6.30.0
- Risolto il problema segnalato dall'utente "Non vedo il modo per installare la web app".
- Il pulsante di installazione in `ProfilePage.tsx` è stato reso sempre visibile, ma viene disabilitato e mostra un testo di aiuto se la PWA non è installabile in quel momento.
- Aggiornata la logica del chatbot in `App.tsx`: quando l'utente chiede di installare l'app ma `isInstallable` è `false`, Ugo ora risponde con un messaggio esplicativo invece di fallire l'azione.
- Aggiornata tutta la documentazione e la versione a 6.30.0.

# Note del 12/09/2025 - v6.28.0
- Trasformata l'applicazione in una Progressive Web App (PWA) per renderla installabile e utilizzabile offline.
- **`manifest.json`**: Creato il file manifest per definire nome, icone, colori e comportamento dell'app.
- **`service-worker.js`**: Implementato un service worker che mette in cache le risorse principali dell'app (shell, script, stili), consentendo un avvio quasi istantaneo e il funzionamento offline.
- **Icone**: Create icone dedicate (standard e "maskable") per una corretta visualizzazione su tutte le piattaforme.
- **Aggiornamento HTML**: Modificato `index.html` per collegare il manifest e registrare il service worker.
- Aggiornata tutta la documentazione e la versione a 6.28.0.

# Note del 11/09/2025 - v6.27.0
- Riprogettata la pagina dei prezzi in base al feedback dell'utente.
- La nuova interfaccia mette in evidenza i pacchetti di ricarica singola ("pacchetti singoli") come opzione principale.
- Gli abbonamenti sono ora presentati come un'alternativa secondaria per un valore aggiunto.
- Aggiunta una casella di controllo "Trasformalo in abbonamento" sulle schede di ricarica per un upsell intelligente.
- Aggiornata tutta la documentazione e la versione a 6.27.0.

# Note del 10/09/2025 - v6.26.0
- Riprogettata completamente la pagina dei prezzi per introdurre un modello di business basato su abbonamenti e un'offerta speciale "Founders Edition".
- La nuova pagina è dinamica, con un selettore per la fatturazione mensile o annuale.
- Questa modifica implementa il punto 1.1 della roadmap ("Introduzione Pagamenti e Piani"), spostandolo di fatto nel log di sviluppo. L'integrazione di un sistema di pagamento reale (es. Stripe) rimane come prossimo passo logico.
- Aggiornata tutta la documentazione e la versione a 6.26.0.

# Note del 09/09/2025 - v6.25.0
- Implementate le "funzionalità nascoste" per il chatbot Ugo come richiesto.
- **Gestione Reclami e Rimborsi**: Ugo ora rileva i reclami, fornisce un rimborso una tantum per sessione e informa che il feedback verrà utilizzato per migliorare il servizio.
- **Invito Community**: Dopo 5 feedback costruttivi, Ugo invita l'utente a una community Telegram esclusiva.
- **Supporto Dialetti**: Ugo ora riconosce e risponde nei dialetti svizzeri con un tono umile.
- **Documentazione**: Creato un nuovo file `Privato/ChatbotNotes.txt` per documentare in dettaglio queste logiche per riferimenti futuri.
- Aggiornata tutta la documentazione e la versione a 6.25.0.

# Note del 08/09/2025 - v6.24.0
- Finalizzata e documentata l'implementazione del selettore di tema (Chiaro/Scuro/Sistema).
- Risolti bug critici in `index.html` (configurazione Tailwind) e `ThemeContext.tsx` che impedivano al selettore di funzionare correttamente.
- Aggiornata la documentazione (README, CHANGELOG) per riflettere la nuova funzionalità stabile.
- Aggiornata la versione a 6.24.0.

# Note del 07/09/2025 - v6.23.0
- Implementata la "Proposta 1: Miglioramenti UI/UX" discussa.
- **Selettore Tema**: Aggiunto `ThemeContext` e un selettore in `ProfilePage` per scegliere tra tema chiaro, scuro o di sistema.
- **Vista a Griglia**: Aggiunto un interruttore in `ResultsDisplay` per passare dalla vista a lista a una nuova vista a griglia più compatta.
- **Sistema di Tagging**: Aggiunta la possibilità di aggiungere/rimuovere tag ai fascicoli. I tag sono salvati sui singoli `ProcessedPageResult` e la ricerca è stata aggiornata per includerli.
- Aggiornata tutta la documentazione e la versione a 6.23.0.

# Note del 06/09/2025 - v6.22.0
- Soddisfatta la richiesta di aggiornare la documentazione per riflettere l'aggiunta dell'importazione da Google Drive.
- Aggiunto un nuovo pulsante "Importa da Drive" in `FileViews.tsx` che integra Google Picker.
- La funzionalità si disattiva elegantemente se le credenziali API (`GOOGLE_CLIENT_ID` e `API_KEY`) non sono configurate.
- Aggiornata tutta la documentazione (README, CHANGELOG, NotePersonali) e la versione a 6.22.0.

# Note del 05/09/2025 - v6.21.0
- Implementata una funzionalità dal backlog: "Pre-elaborazione Immagini".
- Aggiunto un passaggio automatico in `App.tsx` che utilizza OpenCV.js per convertire le immagini in scala di grigi e migliorare il contrasto (CLAHE) prima di inviarle all'API Gemini.
- Questo migliora l'accuratezza dell'OCR e la robustezza dell'analisi AI.
- Aggiornata tutta la documentazione e la versione a 6.21.0.

# Note del 04/09/2025 - v6.20.0
- Implementata un'iniziativa di "Solidificazione UI" dal backlog.
- Riprogettata la barra delle azioni in `ResultsDisplay.tsx` per essere contestuale.
- Le azioni di gruppo ora appaiono solo dopo aver selezionato uno o più fascicoli.
- Questo semplifica l'interfaccia quando non ci sono selezioni attive, rendendo il flusso di lavoro più intuitivo.
- Aggiornata la documentazione e la versione a 6.20.0.

# Note del 03/09/2025 - v6.19.2
- Implementata la richiesta di rendere scaricabili i documenti legali (Termini di Servizio e Privacy Policy).
- Aggiunto un pulsante "Download PDF" in entrambe le pagine, che genera un PDF del contenuto.
- Il PDF generato include la versione corrente dell'applicazione nell'intestazione e nel nome del file.
- Aggiornata la documentazione e la versione a 6.19.2.

# Note del 02/09/2025 - v6.19.1
- Implementata la richiesta di aggiungere un footer globale all'applicazione.
- Rielaborati i layout delle pagine di Login, Registrazione, Prezzi e Changelog per includere il footer in modo consistente, migliorando l'aspetto professionale dell'intera applicazione.
- Aggiornata la documentazione e la versione a 6.19.1.

# Note del 01/09/2025 - v6.19.0
- Implementata la richiesta di aggiungere un framework per la privacy e il consenso.
- Aggiunta la richiesta di accettazione dei Termini e della Privacy Policy alla registrazione.
- Create pagine dedicate per i documenti legali (con testo segnaposto).
- Aggiunto un "Centro Privacy" nella pagina Profilo per centralizzare l'accesso ai documenti e la gestione dell'account.
- Aggiornata la documentazione e la versione a 6.19.0.

# Note del 01/09/2025 - v6.18.0
- Implementata la funzionalità di metadati avanzati discussa.
- **Watermark Potenziato**: La funzione `createWarpedImageFromCorners` ora include l'UUID (primi 8 caratteri) e il timestamp nel watermark visibile su tutte le immagini elaborate.
- **Metadati JSON**: I file `dati_estratti.json` nei ZIP ora contengono una sezione `_metadata` con la versione dell'app, timestamp, modalità, UUID e hash.
- **Metadati PDF**: I PDF generati ora includono metadati invisibili nelle proprietà del file (Titolo, Creatore, Parole Chiave con UUID e hash) per una migliore archiviazione.
- Aggiornata tutta la documentazione e la versione a 6.18.0.

# Note del 31/08/2025 - v6.17.1
- In risposta al feedback dell'utente "Non vedo differenze", ho completamente ridisegnato il layout iniziale.
- Rimosso il banner di benvenuto e implementata una struttura a tre colonne per i passaggi 1, 2 e 3 quando l'area di lavoro è vuota.
- Questo migliora notevolmente l'allineamento visivo e la chiarezza del flusso di lavoro su schermi grandi. Questa modifica rientra nell'iniziativa "Solidificazione UI" dal backlog.
- Aggiornata la documentazione e la versione a 6.17.1.

# Note del 30/08/2025 - v6.17.0
- Implementata la richiesta dell'utente di aggiungere una modalità di acquisizione via email (funzionalità presente nel backlog).
- Creata l'intera interfaccia frontend in `EmailImportView.tsx`, simulando la ricezione di email, la gestione di una whitelist/blacklist e la selezione della modalità di scansione per gli allegati.
- La funzionalità è ora pronta per la futura integrazione con un servizio backend.
- Aggiornata tutta la documentazione (README, CHANGELOG, NotePersonali) e la versione a 6.17.0.

# Note del 29/08/2025 - v6.16.2
- **UI Refinement**: Migliorato il feedback visivo nel componente di caricamento file in risposta al feedback utente. Rimosso il bordo esterno colorato e applicata la colorazione dinamica direttamente alla linea tratteggiata e al pulsante della fotocamera. Questo rende l'interfaccia più pulita e coerente, come parte dell'iniziativa "Solidificazione UI" dal backlog.
- Aggiornata la documentazione e la versione a 6.16.2.

# Note del 28/08/2025 - v6.16.1
- **Miglioramento Flusso Chat**: Implementato un miglioramento dell'esperienza utente per il chatbot Ugo. Ora, quando Ugo esegue un'azione di navigazione, la chat si chiude temporaneamente e si riapre in automatico dopo 1.5 secondi sulla nuova pagina, permettendo una conversazione più fluida.
- **Correzione Bug Cronologia**: Risolto un bug critico in `handleOpenChat` che causava il reset della cronologia della conversazione ogni volta che la finestra della chat veniva aperta. Ora lo storico viene correttamente preservato.
- Aggiornata la documentazione e la versione a 6.16.1.

# Note del 27/07/2025 - v6.16.0
- **Superpotenziamento Chatbot "Ugo"**: Implementate quattro nuove funzionalità avanzate per trasformare Ugo in un assistente proattivo:
  1. **Assistenza Proattiva**: All'apertura, Ugo analizza l'area di lavoro e offre suggerimenti (es. segnala documenti non sicuri, saldo basso, ecc.).
  2. **Esecuzione Azioni**: Ugo ora può eseguire comandi dati in linguaggio naturale, come unire fascicoli specifici, rispondendo con un JSON che l'app interpreta.
  3. **Memoria a Lungo Termine**: La cronologia della chat è ora salvata in IndexedDB, persistendo tra le sessioni.
  4. **Risposte Multimodali**: Ugo può includere contenuti ricchi, come immagini, nelle sue risposte.
- Aggiornato `App.tsx` con la nuova logica, `services/db.ts` per la persistenza della chat e `components/Chatbot.tsx` per l'UI.
- Aggiornata tutta la documentazione e la versione a 6.16.0.

# Note del 26/08/2025 - v6.15.3
- **Potenziamento Chatbot "Ugo"**: Implementate quattro nuove funzionalità per migliorare l'esperienza della chat:
  1. **Saluti Contestuali**: Il messaggio di benvenuto di Ugo ora si adatta alla pagina corrente.
  2. **Risposte Rapide**: Ugo può suggerire le prossime azioni con pulsanti interattivi.
  3. **Feedback Granulare**: Aggiunte icone 👍/👎 per valutare le risposte di Ugo.
  4. **Memoria Conversazione**: La cronologia della chat ora persiste durante la sessione del browser, anche dopo un ricaricamento della pagina.
- Aggiornato il file `App.tsx` con la logica di gestione (sessionStorage, parsing risposte) e il componente `Chatbot.tsx` per l'UI.
- Aggiornata la documentazione e la versione a 6.15.3.

# Note del 25/08/2025 - v6.15.2
- **Implementazione "Easter Egg"**: Implementato il sistema di ricompense "Utenti Gentili". Ora l'assistente 'Ugo' può premiare gli utenti cordiali con ScanCoin bonus (50 SC), basandosi su un'analisi del sentiment della conversazione. La funzione si attiva discretamente dopo il terzo messaggio dell'utente ed è limitata a una ricompensa per sessione per prevenire abusi.

# Note del 24/08/2025 - v6.15.1
- Soddisfatta una richiesta implicita dell'utente: la modalità demo non mostrava la nuova funzionalità di estrazione immagini.
- Aggiornato `services/demoData.ts` per generare un logo di esempio e includerlo in uno dei documenti demo.
- Il set di dati di esempio ora contiene un `ProcessedPageResult` con la proprietà `extractedImages`, rendendo la feature visibile in modalità demo.
- Aggiornata la documentazione e la versione a 6.15.1.

# Note del 23/08/2025 - v6.15.0
- Implementata la "Proposta 1" dall'analisi precedente: **Estrazione Immagini Opzionale**.
- Aggiunto un interruttore nel `ProcessingModeSelector` per attivare/disattivare la funzione.
- L'interruttore è visibile solo per le modalità compatibili (`Chroma`, `Batch`, `Deep`, `Scontrino`).
- Aggiornato `geminiService` per modificare dinamicamente il prompt e lo schema JSON in base all'opzione di estrazione.
- Aggiunta la logica in `App.tsx` per ritagliare le immagini tramite OpenCV.js in base ai `boundingBox` restituiti da Gemini.
- Aggiornato `ResultsDisplay` per mostrare le miniature delle immagini estratte sotto ogni risultato.
- Aggiornata tutta la documentazione e la versione a 6.15.0.

# Note del 22/08/2025 - v6.14.0
- Implementata la "Proposta 2" dall'analisi precedente: **Miglioramento Fotocamera (Ritaglio Manuale)**.
- Dopo lo scatto, l'utente viene ora portato a una nuova schermata `CropView`.
- In questa vista è possibile trascinare i 4 angoli del documento per correggere il rilevamento automatico.
- Durante il trascinamento, una lente d'ingrandimento ("loupe") appare per consentire un posizionamento di alta precisione.
- L'utente può confermare il ritaglio, che applica la correzione prospettica tramite OpenCV.js, o annullare e ripetere lo scatto.
- Aggiornata tutta la documentazione e la versione a 6.14.0.

# Note del 21/08/2025 - v6.13.0
- Implementata la "Proposta 1" dall'analisi precedente, focalizzata su robustezza e sicurezza.
  1. **Persistenza Coda di Lavoro**: La coda di elaborazione viene ora salvata in IndexedDB. Se l'applicazione viene ricaricata, l'elaborazione riprende automaticamente da dove era stata interrotta, prevenendo la perdita di lavoro.
  2. **Filtri di Sicurezza Gemini**: Attivati i filtri di sicurezza integrati di Gemini (`safetySettings`) per bloccare la generazione di contenuti potenzialmente dannosi (incitamento all'odio, molestie, ecc.), rendendo l'applicazione più sicura e responsabile.
- Aggiornata tutta la documentazione e la versione a 6.13.0.

# Note del 20/08/2025 - v6.12.0
- Migliorato il rilevamento dei documenti in `useDocumentScanner.tsx` (OpenCV) abbassando la soglia di area minima. Questo permette di riconoscere anche documenti piccoli come scontrini o fogli piegati, come richiesto dall'utente.
- Aggiornata la documentazione e la versione a 6.12.0.

# Note del 19/08/2025 - v6.11.0
- Implementata la "Modalità Scontrino" dal backlog.
- Creato un nuovo modello AI specializzato in `geminiService` per estrarre dettagliatamente le voci degli scontrini.
- Aggiunta la visualizzazione tabellare dei risultati in una sezione espandibile in `ResultsDisplay`.
- Aggiornata l'intera UI (selettore modalità, modale info, dashboard, profilo) per integrare la nuova modalità.
- Aggiornata tutta la documentazione e la versione a 6.11.0.

# Note del 18/08/2025 - v6.10.0
- Implementato un pacchetto di potenziamento basato sulle idee del backlog:
  1. **Esportazione PDF per Fascicolo**: Aggiunto un pulsante su ogni fascicolo per scaricarlo direttamente come un singolo file PDF multi-pagina.
  2. **Tentativi di Rianalisi Intelligenti**: Introdotta una logica che permette fino a 3 tentativi per correggere una scansione fallita o di bassa qualità. Il costo viene addebitato solo in caso di successo di una scansione precedentemente fallita. Il pulsante si disabilita dopo 3 tentativi.
- Aggiornata tutta la documentazione e la versione a 6.10.0.

# Note del 17/08/2025 - v6.9.9
- **Fix**: Risolto un fastidioso bug di scorrimento sulla pagina "Scansione" che si verificava su dispositivi mobili. Lo scroll tornava continuamente in cima alla pagina.
- Il problema è stato risolto semplificando la struttura CSS del layout in `Workspace.tsx`, in particolare la gestione della colonna "sticky".
- Aggiornata la documentazione e la versione a 6.9.9.

# Note del 16/08/2025 - v6.9.8
- Implementata la configurazione delle modalità primarie da visualizzare nel selettore, gestibile dalla pagina Profilo.
- Migliorata l'UI del selettore modalità, che ora mostra le due modalità primarie e nasconde le altre in una sezione espandibile.
- Rinominato le modalità di scansione con nomi più moderni e descrittivi.
- Aggiornata la documentazione e la versione a 6.9.8.

# Note del 15/08/2025 - v6.9.7
- Implementate diverse proposte dall'utente:
  1. **ZIP Protetto (Punto 1)**: I download sono ora protetti da password (`123456`).
  2. **Logo Navigabile (Punto 2)**: L'header ora reindirizza alla home page.
  3. **Esempi Scansioni (Punto 4)**: La pagina prezzi ora mostra stime del numero di scansioni per pacchetto.
  4. **Cookie Banner e Clarity (Punti 5, 6)**: Aggiunto banner per i cookie e script di Microsoft Clarity.
- Aggiornata tutta la documentazione e la versione a 6.9.7.

# Note del 14/08/2025 - v6.9.6
- Implementato un pacchetto di "vittorie rapide" basato sul feedback dell'utente:
  1. **Flash Automatico (Punto 2)**: Riabilitata la logica per l'attivazione automatica della torcia in `CameraView` e aggiunto un indicatore visivo dello stato del flash.
  2. **Indicatori Visivi per Modalità (Punto 6)**: Aggiunto un bordo laterale colorato a tutti gli elementi nella coda di lavoro (`QueueView`) e nei risultati (`ResultsDisplay`) per identificare a colpo d'occhio la modalità di elaborazione.
  3. **Selezione Modalità Sempre Attiva (Punto 5)**: Rimosso il blocco (`disabled`) dal selettore della modalità in `Workspace`, permettendo un flusso di lavoro più fluido.
- Aggiornata la documentazione e la versione a 6.9.6.

# Note del 13/08/2025
- Aggiunta una lista di nuove idee e proposte fornite dall'utente al backlog per futura valutazione.
- Fornita un'analisi dettagliata delle proposte, raggruppandole per priorità e fattibilità (Vittorie Rapide, Funzionalità Chiave, Funzionalità Avanzate).

# Note del 12/08/2025 - v6.9.5
- Implementata la richiesta dell'utente di aggiungere una modalità gratuita "No-AI".
- Creata la nuova modalità "Acquisisci e Salva" a costo 0 ScanCoin.
- Questa modalità bypassa l'analisi Gemini, eseguendo solo l'acquisizione e l'applicazione del watermark.
- I risultati non hanno dati estratti e ogni scansione crea un fascicolo a sé.
- Aggiornata tutta l'UI (selettore modalità, modale info, coda) e la documentazione per includere la nuova opzione.

# Note del 11/08/2025 - v6.9.3
- In risposta alla richiesta dell'utente, ho ripristinato lo storico delle sessioni, spostandolo dalla pagina Profilo alla Dashboard per una migliore centralizzazione delle informazioni.
- Aggiunto un pulsante per scaricare lo storico completo in formato PDF dalla Dashboard.
- Semplificata la pagina Profilo, che ora si concentra sui dati dell'account e le preferenze.
- Aggiornata la documentazione e la versione a 6.9.3.

# Note del 10/08/2025 - v6.9.4 (retrodatato per coerenza)
- Implementata la "Proposta 1" dall'analisi del file NotePersonali: il "Modello Libro".
- Aggiunta la nuova modalità di elaborazione "book" in `geminiService`, con costo e schema dedicati.
- Aggiornata l'UI in `ProcessingModeSelector`, `ModeInfoModal`, `ResultsDisplay` e `QueueView` per supportare la nuova modalità.
- Creata una nuova icona `BookOpenIcon`.
- Aggiornata tutta la documentazione (README, CHANGELOG, metadata) alla versione 6.9.4.

# Note del 29/07/2025 - v6.5.0
- Implementata una funzionalità dal backlog UI/UX: **Scheda Info per Modelli**.
- Creato il nuovo componente `ModeInfoModal.tsx` che mostra un popup di confronto per le modalità.
- Aggiunta l'icona e la logica per aprire il modale in `Workspace.tsx`.
- Aggiornata tutta la documentazione (README, CHANGELOG, metadata) alla versione 6.5.0.

# Note del 28/07/2025 - v6.4.0
- Implementata la "Proposta 1" (Performance): Il componente `VirtualItem` è stato potenziato per "scaricare" gli elementi che escono dalla vista, implementando una virtualizzazione completa e migliorando drasticamente le performance con lunghe liste.
- Implementata la "Proposta 2" (Onboarding): Aggiunto un banner di benvenuto nell'area risultati (quando vuota) per guidare i nuovi utenti.
- Aggiornata tutta la documentazione (README, CHANGELOG, metadata) alla versione 6.4.0.

# Note del 27/07/2025 - v6.3.0
- Soddisfatta la richiesta dell'utente di rendere l'aggiornamento delle statistiche totali istantaneo. La logica è stata spostata dalla funzione `handleClear` alla funzione `addResult`, che viene attivata per ogni pagina scansionata. Questo risolve la confusione per cui i totali si aggiornavano solo a fine sessione.
- "Pulisci Sessione" ora salva solo lo storico della sessione.
- Aggiornata tutta la documentazione (README, CHANGELOG, metadata) alla versione 6.3.0.

# Note del 26/07/2025 - v6.2.0
- **FIX CRITICO**: Corretto il prompt di Gemini in `geminiService.ts`. Le istruzioni per derivare i dati (`soggetto`, `titoloFascicolo`, ecc.) erano diventate contraddittorie, causando fallimenti nell'analisi AI e nell'estrazione del JSON. La logica è stata resa più sequenziale e chiara.
- **FIX USABILITÀ**: Rimosso il blocco (`disabled`) dal `ProcessingModeSelector` in `Workspace.tsx`. Ora l'utente può cambiare la modalità di elaborazione per i file futuri anche mentre la coda corrente è in esecuzione.
- Aggiornati tutti i file di documentazione e la versione a 6.2.0.

# Note del 25/07/2025 - v6.1.0
- Implementata la "Proposta 1" dalle note precedenti:
  - Aggiunta la barra di ricerca per i fascicoli.
  - Aggiunte scorciatoie da tastiera per Annulla/Ripristina, navigazione tra fascicoli e chiusura modali.
- Implementata la "Proposta 2":
  - Eseguito il refactoring completo di `CameraView.tsx` in tre custom hook (`useCameraStream`, `useDocumentScanner`, `useDeviceTilt`) per migliorare la manutenibilità.
- Aggiornati i file di documentazione e la versione a 6.1.0.

# Note del 24/07/2025 - v6.0.1
- **Fix Fotocamera Critici**: Risolti bug che impedivano lo scatto (manuale e automatico). Corretto il comportamento del flash perché illumini la scena durante la ricerca del documento. Stabilizzata l'intera esperienza di scatto.
- Aggiornata la documentazione e la versione a 6.0.1.

# Note del 23/07/2025 - v6.0.0
- **Major Version Bump**: Su richiesta dell'utente, la versione è stata portata a 6.0.0 per riflettere l'importanza della reintroduzione e stabilizzazione della funzionalità di scansione con OpenCV.
- Le modifiche delle versioni 5.7.0 e 5.7.1 sono state consolidate sotto la nuova versione 6.0.0 nel CHANGELOG.
- L'obiettivo è comunicare chiaramente che la funzionalità della fotocamera è ora una feature principale e matura dell'applicazione.

# Note del 22/07/2025 - v5.7.1
- **Fix UI Fotocamera**: Ripristinata l'interfaccia della fotocamera al layout precedente che era più funzionale e apprezzato dall'utente.
- Il problema era un disallineamento del canvas dell'overlay con il video, causato da tentativi di fix precedenti.
- La soluzione definitiva ha utilizzato CSS Grid per forzare la sovrapposizione perfetta di video e overlay, risolvendo tutti i problemi di layout.
- L'algoritmo di rilevamento potenziato (Canny + morfologia) è stato mantenuto.
- Aggiornata la versione a 5.7.1.

# Note del 21/07/2025 - v5.7.0
- Implementato il rilevamento dei bordi e il ritaglio automatico tramite OpenCV.js.
- L'app ora mostra un contorno in tempo reale sul documento.
- Lo scatto viene automaticamente ritagliato e corretto nella prospettiva.
- La modalità "Scatto Rapido" è stata potenziata per scattare solo quando un documento è rilevato e il dispositivo è in piano.
- Aggiornata la versione a 5.7.0.

# Note del 20/07/2025 - v5.6.0
- Implementata la "Modalità Scatto Rapido" nella fotocamera.
- Aggiunto un interruttore per attivarla e la logica per scattare automaticamente quando il dispositivo è in piano.
- Aggiornata la versione a 5.6.0.

# Note del 19/07/2025 - v5.5.0
- Implementata la funzionalità di feedback per le singole scansioni. L'utente può ora indicare se l'analisi di una pagina è buona o cattiva.
- Aggiunto un campo opzionale `feedback` all'interfaccia `ProcessedPageResult`.
- Aggiornata la versione a 5.5.0 in tutti i file rilevanti (metadata, readme, changelog).

# Note del 18/07/2025 - v5.4.0
- La chat è stata resa persistente, mantenendo la cronologia durante la navigazione. Lo stato è stato spostato in `App.tsx`.
- Documentata la modifica e aggiornata la versione a 5.4.0.

# Note del 17/07/2025 - v5.3.0
Le seguenti modifiche sono state implementate:
- Eseguito il rebranding delle modalità di elaborazione con nomi più commerciali:
  - `Qualità` -> `Pixel Perfect`
  - `Velocità` -> `Flash`
  - `Business` -> `Multi-Task`
- Aggiunto il costo per scansione (es. "0.10 CHF/scan") di fianco alla descrizione di ogni modalità per massima trasparenza.
- Aggiornata tutta l'interfaccia (risultati, coda, profilo) per riflettere i nuovi nomi.

# Note del 16/07/2025
Le seguenti modifiche sono state implementate nella versione 5.2.0:
- Aggiunti indicatori di modalità (con colore) e timestamp a ogni pagina scansionata per una maggiore chiarezza.
- Implementata una filigrana (watermark) con il timestamp sulle immagini elaborate.
- Introdotta la funzione "Riprova Scansione" per rielaborare le singole pagine fallite o di bassa qualità.
- Migliorata la gestione degli errori con messaggi più dettagliati e specifici (connessione, API, file corrotto).
- Aggiornamento di versioning, README e changelog.

# Note del 15/07/2025
Le seguenti modifiche sono state implementate nella versione 5.1.0:
- Introduzione di un conteggio scansioni e costo lato client.
- Differenziazione dei costi per modalità:
    - Qualità: 0.10 CHF / pagina
    - Velocità: 0.07 CHF / pagina
    - Business: 0.15 CHF / pagina
- Aggiornamento di versioning, README e changelog.