<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/icon.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json" crossorigin="use-credentials" />
  <meta name="theme-color" content="#9e5bfe" />
  <link rel="apple-touch-icon" href="/icon.svg" />

  <title>scansioni.ch</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
  <script>tailwind.config = { darkMode: 'class' };</script>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=swap" rel="stylesheet" />

  <!-- Anti-FOUC (tema) -->
  <script>
    (function () {
      const pref = localStorage.getItem('theme') || 'system';
      const dark = matchMedia('(prefers-color-scheme: dark)').matches;
      document.documentElement.classList.toggle('dark', pref === 'dark' || (pref === 'system' && dark));
    })();
  </script>

  <!-- Lib esterne async -->
  <script async src="https://docs.opencv.org/4.x/opencv.js" onload="dispatchEvent(new CustomEvent('opencv-ready'))"></script>
  <script async defer src="https://accounts.google.com/gsi/client"></script>
  <script async defer src="https://apis.google.com/js/api.js" onload="dispatchEvent(new CustomEvent('gapi-ready'))"></script>

  <!-- Import-map -->
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@19.1.1",
    "react/jsx-runtime": "https://esm.sh/react@19.1.1/jsx-runtime",
    "react-dom": "https://esm.sh/react-dom@19.1.1",
    "react-dom/client": "https://esm.sh/react-dom@19.1.1/client",
    "@google/genai": "https://esm.sh/@google/genai@^1.9.0?external=firebase",
    "react-dropzone": "https://esm.sh/react-dropzone@^14.3.8",
    "pdfjs-dist": "https://cdn.jsdelivr.net/npm/pdfjs-dist@4.10.38/build/pdf.mjs",
    "jszip": "https://esm.sh/jszip@3.10.1",
    "file-saver": "https://esm.sh/file-saver@2.0.5",
    "jspdf": "https://esm.sh/jspdf@2.5.1",
    "jspdf-autotable": "https://esm.sh/jspdf-autotable@3.8.2",
    "react-dom/": "https://esm.sh/react-dom@^19.1.1/",
    "react/": "https://esm.sh/react@^19.1.1/",
    "firebase/": "https://esm.sh/firebase@^12.1.0/",
    "otpauth": "https://esm.sh/otpauth@9.2.2",
    "qrcode": "https://esm.sh/qrcode@1.5.3",
    "tesseract.js": "https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.esm.min.js"
  }
}
</script>

  <style>
    html{scroll-behavior:smooth}
    body{
      font-family:'Plus Jakarta Sans',sans-serif;
      background-image:
        linear-gradient(rgba(168,85,247,.04)1px,transparent 1px),
        linear-gradient(90deg,rgba(168,85,247,.04)1px,transparent 1px);
      background-size:40px 40px;
      background-attachment:fixed;
    }
    .material-symbols-outlined {
      font-family: 'Material Symbols Outlined';
      font-weight: normal;
      font-style: normal;
      font-size: 24px;
      line-height: 1;
      letter-spacing: normal;
      text-transform: none;
      display: inline-block;
      white-space: nowrap;
      word-wrap: normal;
      direction: ltr;
      -webkit-font-feature-settings: 'liga';
      -webkit-font-smoothing: antialiased;
      vertical-align: middle;
      user-select: none;
    }
    @keyframes highlight-pulse {
      0%, 100% { background-color: transparent; box-shadow: 0 0 0 0 rgba(168,85,247,.4); }
      50% { background-color: rgba(168,85,247,.1); box-shadow: 0 0 0 15px rgba(168,85,247,0); }
    }
    .highlight-section-animation { animation: highlight-pulse 2.5s ease-in-out; }

    /* --- Scanner BG & lines (per WaitlistPage di scansioni.ch) --- */
    .waitlist-bg-grid{
      position:absolute; inset:0; pointer-events:none; opacity:.2;
      background-image:
        linear-gradient(to right, rgba(255,255,255,.06) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255,255,255,.06) 1px, transparent 1px);
      background-size:24px 24px;
    }
    @keyframes scan-down{
      0%{ top:-10%; opacity:0 }
      10%{ opacity:1 }
      90%{ opacity:1 }
      100%{ top:110%; opacity:0 }
    }
    .scanner-line{
      position:absolute; left:0; right:0; height:2px; top:-10%;
      pointer-events:none; mix-blend-mode:screen;
      background:linear-gradient(90deg, rgba(0,255,255,0), rgba(0,255,255,.9), rgba(0,255,255,0));
      box-shadow:0 0 10px rgba(0,255,255,.7), 0 0 22px rgba(0,255,255,.35);
      animation:scan-down 6.5s linear infinite;
    }
    .scanner-line.line1{ animation-duration:5.2s; animation-delay:0s }
    .scanner-line.line2{ animation-duration:7.1s; animation-delay:.9s }
    .scanner-line.line3{ animation-duration:6.3s; animation-delay:1.8s }
    .scanner-line.line4{ animation-duration:8s;   animation-delay:2.7s }

    .mouse-scanner-line{
      position:absolute; left:0; width:100%; height:1px; opacity:0;
      pointer-events:none; will-change:transform,opacity; transition:opacity .2s ease;
      background:linear-gradient(90deg, rgba(0,255,255,0), rgba(0,255,255,.8), rgba(0,255,255,0));
      box-shadow:0 0 8px rgba(0,255,255,.6), 0 0 18px rgba(0,255,255,.3);
      mix-blend-mode:screen;
    }

    /* Shimmer del bottone */
    @keyframes shimmer{ 0%{transform:translateX(-120%)} 100%{transform:translateX(120%)} }
    .shimmer-effect{
      position:absolute; inset:0; transform:translateX(-120%);
      background:linear-gradient(120deg, transparent, rgba(255,255,255,.35), transparent);
      animation:shimmer 2.4s infinite; pointer-events:none;
    }

    /* Shake del form */
    @keyframes shake {
      10%,90%{ transform:translateX(-1px) }
      20%,80%{ transform:translateX( 2px) }
      30%,50%,70%{ transform:translateX(-4px) }
      40%,60%{ transform:translateX( 4px) }
    }
    .animate-shake{ animation:shake .45s cubic-bezier(.36,.07,.19,.97) both }
    
    /* Toast Animations */
    @keyframes toast-in {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes toast-out {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(100%); opacity: 0; }
    }
    .animate-toast-in { animation: toast-in 0.5s ease-out forwards; }
    .animate-toast-out { animation: toast-out 0.5s ease-out forwards; }
    
    /* --- NUOVO: Stile per feedback su elemento --- */
    .feedback-highlight-target {
      outline: 3px dashed #a855f7 !important; /* purple-500 */
      outline-offset: 3px !important;
      transition: outline 0.1s ease-in-out;
      cursor: crosshair !important;
      border-radius: 4px;
    }

    /* --- REVISED: Stile per UnHubPage --- */
    .unhub-orbital-container {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background-color: #0c0c14; /* Slightly darker */
      color: white;
      perspective: 1000px;
      --unhub-purple: #a855f7;
      --unhub-red: #ef4444;
      --unhub-cyan: #06b6d4;
      --unhub-green: #22c55e;
      --unhub-gray: #6b7280;
    }
    .unhub-orbital-canvas {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      z-index: 0;
      opacity: 0.6;
    }
    .unhub-scene {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      transition: transform 0.2s ease-out;
      will-change: transform;
    }
    .unhub-center-content {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
    }
    .unhub-core {
      position: relative;
      width: 220px; height: 220px;
      border-radius: 50%;
      background: radial-gradient(circle, #2a2a3a 0%, #0c0c14 70%);
      box-shadow: 0 0 30px rgba(168, 85, 247, 0.15), inset 0 0 20px rgba(40, 40, 60, 0.5);
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .unhub-core:hover {
      transform: scale(1.1);
      box-shadow: 0 0 50px rgba(168, 85, 247, 0.3), inset 0 0 30px rgba(60, 60, 90, 0.7);
    }
    .unhub-search-form {
      position: absolute;
      width: 120%;
      opacity: 0;
      transform: scale(0.8);
      transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
      pointer-events: none;
    }
    .unhub-core:hover .unhub-search-form {
      opacity: 1;
      transform: scale(1);
      pointer-events: auto;
    }
    .unhub-search-input {
        width: 100%;
        padding: 12px 16px 12px 48px;
        background-color: rgba(12, 12, 20, 0.8);
        border: 2px solid #4a4a5a;
        border-radius: 9999px;
        color: white;
        font-size: 1rem;
        outline: none;
        transition: border-color 0.2s;
    }
    .unhub-search-input:focus {
        border-color: var(--unhub-purple);
    }
    .unhub-satellite {
      position: absolute;
      top: 50%; left: 50%;
      width: 60px; height: 60px;
      margin: -30px 0 0 -30px; /* Center it */
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #1a1a2a;
      border: 2px solid var(--satellite-color);
      box-shadow: 0 0 15px 0px var(--satellite-color);
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      will-change: transform;
    }
    .unhub-satellite:hover {
      box-shadow: 0 0 25px 8px var(--satellite-color);
      transform: var(--transform-string, 'scale(1)') scale(1.5) !important;
    }
    .unhub-satellite-label {
      position: absolute;
      bottom: 120%;
      background-color: rgba(0, 0, 0, 0.7);
      padding: 4px 10px;
      border-radius: 5px;
      font-size: 0.8rem;
      font-weight: 600;
      white-space: nowrap;
      opacity: 0;
      transition: opacity 0.2s ease-in-out;
      pointer-events: none;
    }
    .unhub-satellite:hover .unhub-satellite-label {
        opacity: 1;
    }
    .material-symbols-outlined {
        font-variation-settings: 'FILL' 1;
    }


    /* Riduzione animazioni se richiesto dall'utente */
    @media (prefers-reduced-motion: reduce){
      .scanner-line,.mouse-scanner-line,.shimmer-effect,.animate-shake,
      .animate-toast-in, .animate-toast-out,
      .unhub-core, .unhub-satellite, .unhub-scene {
        animation:none !important; transition:none !important;
      }
    }
  </style>
</head>

<body class="bg-slate-50 dark:bg-slate-900">
  <noscript>Devi abilitare JavaScript per usare questo sito.</noscript>
  <div id="root"></div>

  <script type="module" src="/index.tsx"></script>
  <script>
    if ('serviceWorker' in navigator && !/usercontent.goog/.test(location.hostname)) {
      addEventListener('load', () => navigator.serviceWorker
        .register('/service-worker.js')
        .then(r => console.log('[SW] OK', r))
        .catch(e => console.log('[SW] KO', e)));
    }
  </script>
</body>
</html>