<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/icon.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json" crossorigin="use-credentials" />
  <meta name="theme-color" content="#9e5bfe" />
  <link rel="apple-touch-icon" href="/icon.svg" />

  <title>scansioni.ch</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=swap" rel="stylesheet" />

  <!-- Anti-FOUC (tema) -->
  <script>
    (function () {
      const pref = localStorage.getItem('theme') || 'system';
      const dark = matchMedia('(prefers-color-scheme: dark)').matches;
      document.documentElement.classList.toggle('dark', pref === 'dark' || (pref === 'system' && dark));
    })();
  </script>

  <!-- Lib esterne async -->
  <script async src="https://docs.opencv.org/4.x/opencv.js" onload="dispatchEvent(new CustomEvent('opencv-ready'))"></script>
  <script async defer src="https://accounts.google.com/gsi/client"></script>
  <script async defer src="https://apis.google.com/js/api.js" onload="dispatchEvent(new CustomEvent('gapi-ready'))"></script>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-E4SMRP3VWB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-E4SMRP3VWB');
  </script>
</head>

<body class="bg-slate-50 dark:bg-slate-900">
  <noscript>Devi abilitare JavaScript per usare questo sito.</noscript>
  <div id="root"></div>

  <!-- Vite will inject the compiled JavaScript here -->
  <script type="module" src="/index.tsx"></script>
  
  <script>
    if ('serviceWorker' in navigator && !/usercontent.goog/.test(location.hostname)) {
      addEventListener('load', () => navigator.serviceWorker
        .register('/service-worker.js')
        .then(r => console.log('[SW] OK', r))
        .catch(e => console.log('[SW] KO', e)));
    }
  </script>
</body>
</html>